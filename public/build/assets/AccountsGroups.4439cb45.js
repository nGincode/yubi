import{r as p,j as a,F as k,a as e,H as j,L as D,S as b,T as g}from"./app.0e4dd774.js";import{P as T,S as P,D as S,V as q}from"./PermissionData.6cba3e2d.js";import{B as A}from"./Button.f2d444e5.js";import"./Input.fc52971b.js";function G(r){var h;const m="accounts_groups",i="Groups",n=T("Auth",r.permission,(h=r.groups)==null?void 0:h.groups.data,m),[_,l]=p.exports.useState(!1),d=async s=>{if(s==="create"){var o=new FormData($("#createForm")[0]);try{await axios({method:"POST",url:"/api/groups/create",data:o,headers:{"Content-Type":"multipart/form-data",Accept:"application/json",Authorization:`Bearer ${r.auth.user.token_api}`,"X-CSRF-TOKEN":r.csrf_token}}).then(t=>{if(setTimeout(()=>{l(!1)},5e3),d("view"),g(t.data.response,t.data.message),t.data.response==="success"){$("#DataTables").DataTable().ajax.reload(),$("#createForm")[0].reset(),$(".is-valid").removeClass("is-valid");for(let c=0;c<$(`input[name='${u[0]}[]']`).length;c++)setTimeout(()=>{$(".react-select__multi-value__remove").trigger("click")},1);d("view")}})}catch(t){g("error",t.message),setTimeout(()=>{l(!1)},5e3)}}},v=[{value:"All",label:"All"},{value:"Store",label:"Store"},{value:"Division",label:"Division"},{value:"Private",label:"Private"}],N=[{subject:"Report",data:["report_presence","report_equipment","report_vouchers","report_manual_stock","report_moka"]},{subject:"Accounts",data:["accounts_users","accounts_store","accounts_groups","accounts_contact"]},{subject:"Presence",data:["presence_absent","presence_schedule","presence_work_permit"]},{subject:"Equipment",data:["equipment_master","equipment_changed","equipment_stock"]},{subject:"Vouchers",data:["vouchers_scan","vouchers_contact"]},{subject:"Ingredient",data:["ingredient_library","ingredient_category","ingredient_recipes"]},{subject:"Library",data:["library_item","library_category","library_sales_type"]},{subject:"Wage",data:["wage_base_salary","wage_salary_up","wage_bonus","wage_debt","wage_payslips"]},{subject:"Manual",data:["manual_stock_master","manual_stock"]}],f={name:{required:!0,minlength:3,maxlength:50},"permission[]":{required:!0},data_display:{required:!0}},u=["target"],y={nameUpdate:{required:!0,minlength:3,maxlength:50},"permissionUpdate[]":{required:!0},data_displayUpdate:{required:!0}},w=["targetUpdate"],x=s=>{l(!0),s.preventDefault(),q("#createForm",f,u)?d("create"):l(!1)};return p.exports.useEffect(()=>{$("#main-wrapper").removeClass("menu-toggle"),$(".hamburger ").removeClass("is-active")},[]),a(k,{children:[e(j,{title:i}),e("div",{className:"row page-titles",children:a("div",{className:"breadcrumb",children:[e("li",{className:"breadcrumb-item",children:e("a",{children:"Accounts"})}),e("li",{className:"breadcrumb-item  active",children:e(D,{href:route(m),children:i})})]})}),e(P,{}),a("div",{id:"content",children:[n.create&&e("div",{className:"col-xl-12 ",children:a("div",{className:"card",children:[e("div",{className:"card-header coin-card",children:e("h4",{className:"card-title text-white",children:e("b",{children:i})})}),e("div",{className:"card-body",children:e("div",{className:"basic-form",children:a("form",{id:"createForm",onSubmit:x,children:[a("div",{className:"row",children:[e("div",{className:"mb-6 col-md-12",children:a("div",{className:"form-group",children:[e("label",{htmlFor:"nama",children:"Name Group"}),e("input",{type:"text",className:"form-control",id:"name",name:"name",placeholder:"Name Group"})]})}),e("div",{className:"mb-6 col-md-12",children:e("div",{className:"form-group",children:a("table",{className:"table",children:[e("thead",{children:a("tr",{children:[e("th",{scope:"col",children:e("b",{children:"Permission"})}),e("th",{scope:"col",children:e("center",{children:e("span",{className:"badge badge-primary",children:e("i",{className:"fa fa-eye"})})})}),e("th",{scope:"col",children:e("center",{children:e("span",{className:"badge badge-success",children:e("i",{className:"fa fa-plus"})})})}),e("th",{scope:"col",children:e("center",{children:e("span",{className:"badge badge-warning",children:e("i",{className:"fa fa-pencil"})})})}),e("th",{scope:"col",children:e("center",{children:e("span",{className:"badge badge-danger",children:e("i",{className:"fa fa-trash"})})})})]})}),N.map((s,o)=>a("tbody",{children:[e("tr",{children:e("td",{children:e("b",{children:s.subject})})}),s.data.map((t,c)=>a("tr",{children:[e("td",{style:{textTransform:"capitalize",paddingLeft:"20px"},children:`${c+1}) ${t.replace("_"," ").replace("_"," ").replace(s.subject.toLowerCase(),"")}`}),e("td",{children:e("center",{children:e("input",{type:"checkbox",name:"permission[]",value:"view"+t,className:"minimal"})})}),e("td",{children:e("center",{children:e("input",{type:"checkbox",name:"permission[]",value:"create"+t,className:"minimal"})})}),e("td",{children:e("center",{children:e("input",{type:"checkbox",name:"permission[]",value:"update"+t,className:"minimal"})})}),e("td",{children:e("center",{children:e("input",{type:"checkbox",name:"permission[]",value:"delete"+t,className:"minimal"})})})]},c))]},o))]})})}),e("div",{className:"mb-6 col-md-12",children:a("div",{className:"form-group",children:[e("label",{className:"form-label",children:"Data Display"}),e(b,{id:"data_display",name:"data_display",defaultValue:"",data:v})]})}),e("div",{className:"mb-6 col-md-12",children:a("div",{className:"form-group",children:[e("label",{className:"form-label",children:"Target Users"}),e(b,{id:"target",name:"target[]",data:r.groupsUniqueSelect,multi:!0})]})})]}),e("hr",{}),e(A,{type:"submit",className:"btn btn-primary",processing:_,children:"Submit"})]})})})]})}),n.view&&e("div",{className:"col-12",children:a("div",{className:"card",children:[e("div",{className:"card-header bg-secondary",children:e("h4",{className:"card-title  text-white",children:a("b",{children:["Data ",i]})})}),e("div",{className:"card-body",children:e("div",{className:"table-responsive",children:e(S,{columns:[{data:"name",title:"Name"},{data:"permission",title:"Permission"},{data:"data",title:"Data Display"},{data:"users",title:"Users"},{data:"action",title:"Action",orderable:!1,width:50,className:"text-right"}],API:"/api/groups",Method:"POST",Subject:"Groups",setValidate:y,setValidate2:w,api_token:`Bearer ${r.auth.user.token_api}`,Action:n.managePerm,csrf_token:r.csrf_token})})})]})})]})]})}export{G as default};
